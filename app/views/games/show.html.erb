<DOCTYPE html>
<html>

<head>


</head>

	<body>

		<h1>Welcome to Pawn Shop</h1>

		<table>
      <% 8.downto(1) do |column| %>
        <tr class="column <%= column %>">
          <% 1.upto(8) do |row| %>
            <td class=square id="<%= row %> <%= column %>">
              <!--check to see if there is a piece-->
							<% piece = @piece %>
							<div class="piece" id="<%= @piece_params %>">
								<% @game.pieces.each do | piece | %>
										<% if piece.x_coordinate == row && piece.y_coordinate == column %>
											<%= image_tag("#{piece.color}#{piece.type.downcase}.png") %>
										<% end %>
	              <% end %>
							</div>
            </td>
          <% end %>
        </tr>
      <% end %>
    </table>

		<script>
			$(function() {
				$('.piece').draggable({ snap: '.square' });
				$('.square').droppable({
				  drop: function( event, ui ) {
						var piece_id = $('.piece').attr('id');
						var location = $(this).attr('id');
						var game_id = $().attr('id');
						$( this )
	            alert(piece_id + ' ' + location);
						$.ajax({
							type: 'PUT',
							url: 3 + '/pieces/' + piece_id,
							dataType: 'json',
							data: { piece_id: {piece_params: location} },
							success: function(data) {
 								$(location).attr('href', data.update_url);
 							}
						})
					}
				});
			});

		</script>

	</body>


</html>
